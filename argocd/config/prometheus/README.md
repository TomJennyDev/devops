# Prometheus Helm Values - Reference Guide

## ğŸ“¦ Official Sources

All files in this directory are based on **official Prometheus Community Helm Chart**:

- **Chart Repository**: https://github.com/prometheus-community/helm-charts
- **Chart Name**: `kube-prometheus-stack`
- **Chart Version**: `65.2.0`
- **Helm Repo URL**: https://prometheus-community.github.io/helm-charts
- **ArtifactHub**: https://artifacthub.io/packages/helm/prometheus-community/kube-prometheus-stack
- **License**: Apache 2.0
- **Maintained by**: Prometheus Community

### Official Documentation:
- **Prometheus**: https://prometheus.io/docs/
- **Grafana**: https://grafana.com/docs/grafana/latest/
- **AlertManager**: https://prometheus.io/docs/alerting/latest/alertmanager/
- **Prometheus Operator**: https://prometheus-operator.dev/
- **Node Exporter**: https://github.com/prometheus/node_exporter
- **Kube State Metrics**: https://github.com/kubernetes/kube-state-metrics

## ğŸ“ Files trong thÆ° má»¥c nÃ y:

### 1. **default-values-reference.yaml** (5413 dÃ²ng)
- **Source**: Official Helm chart `prometheus-community/kube-prometheus-stack` v65.2.0
- **Generated by**: `helm show values prometheus-community/kube-prometheus-stack`
- **Purpose**: Reference Ä‘áº§y Ä‘á»§ ALL possible options with official comments
- **Official Source**: https://github.com/prometheus-community/helm-charts/blob/main/charts/kube-prometheus-stack/values.yaml
- **Usage**: TÃ¬m kiáº¿m options báº¡n cáº§n, sau Ä‘Ã³ copy vÃ o dev/staging/prod values
- **Last Updated**: 2025-11-25

### 2. **dev-values.yaml** (Custom - Based on Official Chart)
- **Base**: kube-prometheus-stack v65.2.0 defaults
- **Customization Level**: Minimal - only overrides for Dev environment
- Override cho Dev environment
- Chá»‰ chá»©a settings khÃ¡c vá»›i default
- Optimized cho cost (low resources, short retention)
- **Verified Against**: default-values-reference.yaml

### 3. **staging-values.yaml** (Custom)
- Override cho Staging environment
- Medium resources, HA vá»›i 2 replicas

### 4. **prod-values.yaml** (Custom)
- Override cho Production environment
- High resources, full HA vá»›i 3 replicas, anti-affinity

## ğŸ” CÃ¡ch sá»­ dá»¥ng default-values-reference.yaml:

### TÃ¬m kiáº¿m option báº¡n cáº§n:

```bash
# TÃ¬m retention settings
grep -n "retention" default-values-reference.yaml

# TÃ¬m storage settings
grep -n "storage" default-values-reference.yaml

# TÃ¬m Grafana settings
grep -n "grafana:" default-values-reference.yaml

# TÃ¬m ingress settings
grep -n "ingress:" default-values-reference.yaml
```

### Copy vÃ o custom values:

1. TÃ¬m section báº¡n cáº§n trong `default-values-reference.yaml`
2. Copy structure vÃ o `dev-values.yaml` / `staging-values.yaml` / `prod-values.yaml`
3. Chá»‰ override values khÃ¡c vá»›i default
4. ThÃªm comments giáº£i thÃ­ch táº¡i sao override

## ğŸ“– Cáº¥u trÃºc chÃ­nh trong default-values-reference.yaml:

```yaml
# Line ~1-100: Global settings
nameOverride, namespaceOverride, commonLabels

# Line ~100-500: CRDs & Prometheus Operator
prometheusOperator:
  resources, replicas, nodeSelector, tolerations

# Line ~500-2500: Prometheus Server
prometheus:
  prometheusSpec:
    retention, retentionSize
    resources, replicas
    storageSpec
    scrapeInterval, evaluationInterval
    serviceMonitorSelector
    ruleSelector
    alertingEndpoints
    remoteWrite, remoteRead
    affinity, tolerations

# Line ~2500-3500: Grafana
grafana:
  enabled
  adminPassword
  resources, replicas
  persistence
  ingress
  datasources
  dashboardProviders
  dashboards
  grafana.ini

# Line ~3500-4000: AlertManager
alertmanager:
  enabled
  alertmanagerSpec:
    resources, replicas
    storage
    config  # routing, receivers

# Line ~4000-4500: Other exporters
nodeExporter:
  enabled, resources
kubeStateMetrics:
  enabled, resources
prometheusNodeExporter:
  enabled, resources

# Line ~4500-5413: Service Monitors & Rules
defaultRules:
  create, rules (cÃ¡c rule groups)
```

## ğŸ’¡ Best Practices:

### âœ… DO:
- Tham kháº£o `default-values-reference.yaml` Ä‘á»ƒ biáº¿t options cÃ³ sáºµn
- Chá»‰ override nhá»¯ng gÃ¬ cáº§n thiáº¿t trong custom values
- ThÃªm comments giáº£i thÃ­ch WHY override
- Test vá»›i `helm template` trÆ°á»›c khi deploy

### âŒ DON'T:
- KhÃ´ng copy toÃ n bá»™ 5413 dÃ²ng vÃ o custom values
- KhÃ´ng hardcode passwords trong Git (dÃ¹ng Sealed Secrets)
- KhÃ´ng set resources quÃ¡ tháº¥p (Prometheus cáº§n RAM)

## ğŸ¯ Examples:

### TÃ¬m vÃ  override Grafana ingress:

```bash
# 1. TÃ¬m trong reference
grep -A 20 "grafana:" default-values-reference.yaml | grep -A 10 "ingress:"

# 2. Copy structure vÃ  override
```

```yaml
# prod-values.yaml
grafana:
  ingress:
    enabled: true
    ingressClassName: alb
    annotations:
      alb.ingress.kubernetes.io/scheme: internet-facing
      alb.ingress.kubernetes.io/certificate-arn: "arn:aws:acm:..."
    hosts:
      - grafana.example.com
```

### TÃ¬m vÃ  override Prometheus remote write:

```bash
grep -A 30 "remoteWrite:" default-values-reference.yaml
```

```yaml
# prod-values.yaml
prometheus:
  prometheusSpec:
    remoteWrite:
      - url: https://prometheus-remote.example.com/write
        basicAuth:
          username:
            name: remote-write-creds
            key: username
          password:
            name: remote-write-creds
            key: password
```

## ğŸ“š Official Documentation:

- **Chart Repository**: https://github.com/prometheus-community/helm-charts
- **Chart Hub**: https://artifacthub.io/packages/helm/prometheus-community/kube-prometheus-stack
- **Prometheus Docs**: https://prometheus.io/docs/
- **Grafana Docs**: https://grafana.com/docs/

## ğŸ”„ Update Reference File:

```bash
# Khi cÃ³ version má»›i cá»§a chart
helm repo update
helm show values prometheus-community/kube-prometheus-stack > default-values-reference.yaml

# Check version
helm search repo prometheus-community/kube-prometheus-stack
```

## ğŸ“ Notes:

- File `default-values-reference.yaml` lÃ  **READ-ONLY reference**
- KhÃ´ng Ä‘Æ°á»£c deploy trá»±c tiáº¿p file nÃ y
- LuÃ´n táº¡o custom values riÃªng cho tá»«ng environment
- Keep custom values minimal (chá»‰ override cáº§n thiáº¿t)
