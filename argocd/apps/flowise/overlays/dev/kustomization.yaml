apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Reference base configuration

# Namespace for dev environment
namespace: flowise-dev

# Common labels for dev
commonLabels:
  environment: dev

# Additional resources for dev
resources:
- ingress.yaml
- ../../base

# Patches specific to dev environment
patchesStrategicMerge:
- deployment-restart-patch.yaml
- deployment-patch.yaml

# Images will be updated by GitHub Actions
# kustomize edit set image flowise-server=...
# kustomize edit set image flowise-ui=...
images:
- name: flowise-server
  newName: 372836560690.dkr.ecr.ap-southeast-1.amazonaws.com/flowise-server
- digest: sha256:950b029cf30e94e100dbf63b0d3292d1502563dc4e3c5fc79f3ce9728cd0a611
  name: flowise-ui
  newName: 372836560690.dkr.ecr.ap-southeast-1.amazonaws.com/flowise-ui

# ConfigMap generator for dev-specific config
configMapGenerator:
- literals:
  - ENVIRONMENT=dev
  - LOG_LEVEL=debug
  - DEBUG=true
  name: flowise-env

# Secret generator for dev (use sealed-secrets or external-secrets in production)
secretGenerator:
- literals:
  - database-host=postgres.flowise-dev.svc.cluster.local
  - database-user=flowise_dev
  - database-password=dev-password-123
  name: flowise-secrets
